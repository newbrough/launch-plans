{
  "pyon":{
    "username": "${epu_username}",
    "groupname": "${epu_groupname}",
    "action": [
      "configure",
      "run"
    ],
    "configure_config":{
      "logging_config_file": "/home/${epu_username}/coi-services/res/config/logging.local.yml",
      "logging_config":{
        "handlers":{
          "gray":{
            "class": "graypy.GELFHandler",
             "host": "${graylog_host}"
          }
        },
        "root":{
          "handlers": ["gray", "console", "file"]
        }
      },
      "config_file": "/home/${epu_username}/coi-services/res/config/pyon.local.yml",
      "config":{
        "server":{
          "amqp":{
            "host": "${rabbitmq_host}",
            "username": "${rabbitmq_username}",
            "password": "${rabbitmq_password}"
          },
          "amqp_priv":{
            "host": "${rabbitmq_host}",
            "username": "${rabbitmq_username}",
            "password": "${rabbitmq_password}"
          },
          "couchdb":{
            "host": "${couchdb_host}",
            "username": "${couchdb_username}",
            "password": "${couchdb_password}"
          }
        },
        "endpoint": {
          "receive": {
            "timeout": 60
          }
        },
        "container": {
          "sflow": {
            "hsflowd_port": 36343,
            "enabled": "True"
          }
        },
        "system":{
          "auto_bootstrap": "False",
          "name": "${coi_services_system_name}"
        }
      }
    },
    "run_config": {
      "program": "processdispatcher",
      "name": "processdispatcher",
      "system_name": "${coi_services_system_name}",
      "module": "ion.services.cei.process_dispatcher_service",
      "class": "ProcessDispatcherService",
      "run_directory": "/home/${epu_username}/coi-services",
      "run_method": "supervised",
      "supervisord_path": "/home/${epu_username}/coi-services/bin/supervisord",
      "autorestart": true,
      "config": {
        "processdispatcher": {
          "heartbeat_queue" : "processdispatcher_heartbeats",
          "backend": "native",
          "dashi_uri": "amqp://${rabbitmq_username}:${rabbitmq_password}@${rabbitmq_host}/",
          "dashi_exchange": "${rabbitmq_exchange}",
          "definition_id": "pd_definition",
          "dashi_messaging": true,
          "domain_config": {
            "engine_conf": {
                "iaas_site": "${iaas_site}",
                "iaas_allocation": "m1.small",
                "deployable_type": "${worker_deployable_type}"
            }
          },
          "default_engine": "default",
          "engines": {
            "default": {
              "slots": 100,
              "replicas": 1,
              "base_need": 2
            },
            "service_gateway": {
              "slots": 1,
              "replicas": 1,
              "base_need": 4,
              "config": {
                "unique_key": "ddns_hostname",
                "unique_values": "${gateway_ddns_hosts}"
              }
            }
          }
        }
      }
    }
  },
  "hsflowd": {
    "collector_ip": "69.196.58.199",
    "json_port": "36343"
  },
  "recipes": [
    "hsflowd::config",
    "epu"
  ]
}
